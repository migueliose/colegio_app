{% extends "web/base.html" %}
{% load static %}
{% load web_extras %}

{% block title %}Contacto | Colegio Cristiano El Shadai{% endblock %}

{% block content %}
<div class="contact-page">
  <!-- Hero Section -->
  <section class="page-header py-5">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto text-center">
          <h1 class="display-5 fw-bold text-primary mb-3">Contáctanos</h1>
          <p class="lead text-muted mb-0">Estamos aquí para responder tus preguntas y ayudarte en lo que necesites</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Contenido Principal -->
  <section class="contact-main py-4 py-lg-5">
    <div class="container">
      <div class="row g-4 g-lg-5">
        
        <!-- Información de Contacto -->
        <div class="col-lg-6">
          <div class="contact-info card border-0 shadow-sm h-100">
            <div class="card-body p-4 p-lg-5">
              <h2 class="card-title text-primary fw-bold mb-4">
                <i class="fas fa-info-circle me-2"></i>Información de Contacto
              </h2>

              <!-- Items de Contacto -->
              <div class="contact-items">
                <div class="contact-item d-flex align-items-start gap-3 mb-4">
                  <div class="icon-circle bg-primary text-light">
                    <i class="fas fa-map-marker-alt"></i>
                  </div>
                  <div>
                    <h5 class="fw-semibold mb-1">Dirección</h5>
                    <p class="mb-0 text-muted">
                      Tv 26 No 16E-39<br>
                      Valledupar, Cesar, Colombia
                    </p>
                  </div>
                </div>

                <div class="contact-item d-flex align-items-start gap-3 mb-4">
                  <div class="icon-circle bg-primary text-light">
                    <i class="fas fa-phone"></i>
                  </div>
                  <div>
                    <h5 class="fw-semibold mb-1">Teléfono</h5>
                    <p class="mb-0">
                      <a href="tel:+573188868070" class="contact-link">
                        318 886 8070
                      </a>
                    </p>
                  </div>
                </div>

                <div class="contact-item d-flex align-items-start gap-3 mb-4">
                  <div class="icon-circle bg-primary text-light">
                    <i class="fas fa-envelope"></i>
                  </div>
                  <div>
                    <h5 class="fw-semibold mb-1">Correo Electrónico</h5>
                    <p class="mb-0">
                      <a href="mailto:migueliose@colegiocrishadai.edu.co" class="contact-link">
                        migueliose@colegiocrishadai.edu.co
                      </a>
                    </p>
                  </div>
                </div>

                <div class="contact-item d-flex align-items-start gap-3 mb-4">
                  <div class="icon-circle bg-primary text-light">
                    <i class="fas fa-clock"></i>
                  </div>
                  <div>
                    <h5 class="fw-semibold mb-1">Horario de Atención</h5>
                    <p class="mb-0 text-muted">
                      Lunes a Viernes: 7:00 AM - 4:00 PM<br>
                      Sábados: 8:00 AM - 12:00 PM
                    </p>
                  </div>
                </div>
              </div>

              <!-- Redes Sociales -->
              <div class="social-section mt-5 pt-3 border-top">
                <h5 class="fw-bold mb-3">Síguenos en:</h5>
                <div class="social-links d-flex flex-wrap gap-2">
                  {% get_social_links as redes_sociales %}
                  {% if redes_sociales %}
                    {% for red in redes_sociales %}
                      <a href="{{ red.link }}" target="_blank" rel="noopener noreferrer" 
                         class="social-link btn btn-outline-primary btn-sm" 
                         aria-label="{{ red.name }}" 
                         title="{{ red.name }}">
                        <i class="{{ red.icon_class }} me-1"></i>
                        <span class="d-none d-md-inline">{{ red.name }}</span>
                      </a>
                    {% endfor %}
                  {% else %}
                    <a href="#" class="social-link btn btn-outline-primary btn-sm">
                      <i class="fab fa-facebook-f me-1"></i>
                      <span class="d-none d-md-inline">Facebook</span>
                    </a>
                    <a href="#" class="social-link btn btn-outline-primary btn-sm">
                      <i class="fab fa-instagram me-1"></i>
                      <span class="d-none d-md-inline">Instagram</span>
                    </a>
                    <a href="#" class="social-link btn btn-outline-primary btn-sm">
                      <i class="fab fa-youtube me-1"></i>
                      <span class="d-none d-md-inline">YouTube</span>
                    </a>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Formulario de Contacto -->
        <div class="col-lg-6">
          <div class="contact-form card border-0 shadow-sm">
            <div class="card-body p-4 p-lg-5">
              <h2 class="card-title text-primary fw-bold mb-3">
                <i class="fas fa-paper-plane me-2"></i>Envíanos un Mensaje
              </h2>
              <p class="text-muted mb-4">Completa el formulario y nos pondremos en contacto contigo pronto.</p>

              <!-- Mensajes -->
              {% if messages %}
                <div class="messages mb-4">
                  {% for message in messages %}
                    <div class="alert alert-{{ message.tags|default:'info' }} alert-dismissible fade show d-flex align-items-center" role="alert">
                      <i class="fas 
                        {% if message.tags == 'success' %}fa-check-circle
                        {% elif message.tags == 'error' %}fa-exclamation-circle
                        {% elif message.tags == 'warning' %}fa-exclamation-triangle
                        {% else %}fa-info-circle
                        {% endif %} me-2"></i>
                      <div>{{ message }}</div>
                      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                  {% endfor %}
                </div>
              {% endif %}

              <!-- Formulario -->
              <form method="POST" novalidate class="needs-validation" id="contactForm">
                {% csrf_token %}
                
                <div class="row g-3">
                  <!-- Nombre -->
                  <div class="col-md-6">
                    <label for="{{ form.name.id_for_label }}" class="form-label fw-semibold">
                      Nombre Completo <span class="text-danger">*</span>
                    </label>
                    {{ form.name }}
                    {% if form.name.errors %}
                      <div class="invalid-feedback d-block">{{ form.name.errors.0 }}</div>
                    {% endif %}
                  </div>

                  <!-- Teléfono -->
                  <div class="col-md-6">
                    <label for="{{ form.phone.id_for_label }}" class="form-label fw-semibold">
                      Teléfono
                    </label>
                    {{ form.phone }}
                    {% if form.phone.errors %}
                      <div class="invalid-feedback d-block">{{ form.phone.errors.0 }}</div>
                    {% endif %}
                  </div>
                </div>

                <!-- Email -->
                <div class="mt-3">
                  <label for="{{ form.email.id_for_label }}" class="form-label fw-semibold">
                    Correo Electrónico <span class="text-danger">*</span>
                  </label>
                  {{ form.email }}
                  {% if form.email.errors %}
                    <div class="invalid-feedback d-block">{{ form.email.errors.0 }}</div>
                  {% endif %}
                </div>

                <!-- Mensaje -->
                <div class="mt-3">
                  <label for="{{ form.content.id_for_label }}" class="form-label fw-semibold">
                    Mensaje <span class="text-danger">*</span>
                  </label>
                  {{ form.content }}
                  {% if form.content.errors %}
                    <div class="invalid-feedback d-block">{{ form.content.errors.0 }}</div>
                  {% endif %}
                  <div class="form-text mt-1">
                    Describe tu consulta o solicitud de información. Nos pondremos en contacto en un plazo máximo de 24 horas.
                  </div>
                </div>

                <!-- Botón de Envío -->
                <div class="d-grid mt-4">
                  <button type="submit" class="btn btn-primary btn-lg py-3">
                    <i class="fas fa-paper-plane me-2"></i>
                    Enviar Mensaje
                  </button>
                </div>

                <!-- Nota -->
                <div class="text-center mt-3">
                  <small class="text-muted">
                    <i class="fas fa-shield-alt me-1"></i>
                    Tu información está protegida y no será compartida con terceros.
                  </small>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Mapa -->
  <section class="map-section py-5 bg-light">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto text-center">
          <h2 class="display-6 fw-bold text-primary mb-3">Nuestra Ubicación</h2>
          <p class="lead text-muted mb-4">Visítanos en nuestras instalaciones para conocernos mejor</p>
          
          <div class="map-container rounded-4 overflow-hidden shadow-lg border border-2 border-primary">
            <iframe 
              src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d7847.084207412652!2d-73.266084!3d10.457863!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e8ab92306fb9271%3A0xd05a755c137ff066!2sColegio%20Cristiano%20El%20Shadai!5e0!3m2!1ses!2sus!4v1763347406834!5m2!1ses!2sus" 
              width="100%" 
              height="450" 
              style="border:0;" 
              allowfullscreen="" 
              loading="lazy" 
              referrerpolicy="no-referrer-when-downgrade"
              title="Ubicación del Colegio Cristiano El Shadai">
            </iframe>
          </div>
          
          <div class="mt-4">
            <a href="https://maps.google.com/?q=Colegio+Cristiano+El+Shadai+Valledupar" 
               target="_blank" 
               class="btn btn-outline-primary">
              <i class="fas fa-directions me-2"></i>Abrir en Google Maps
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

{% endblock %}

{% block extra_css %}
<style>
  /* Estilos específicos para la página de contacto */
  .contact-page .page-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
    color: var(--text-light);
  }
  
  .contact-page .page-header .text-primary {
    color: var(--text-light) !important;
  }
  
  .contact-page .page-header .text-muted {
    color: rgba(255, 255, 255, 0.8) !important;
  }
  
  .contact-page .icon-circle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: 1.2rem;
  }
  
  .contact-page .contact-link {
    color: var(--primary-color);
    text-decoration: none;
    transition: color var(--transition-normal);
  }
  
  .contact-page .contact-link:hover {
    color: var(--accent-color);
    text-decoration: underline;
  }
  
  .contact-page .social-links .btn {
    border-radius: 25px;
    padding: 0.5rem 1rem;
  }
  
  .contact-page .map-container {
    position: relative;
    border: 2px solid var(--border-color);
  }
  
  /* Modo oscuro */
  [data-theme="dark"] .contact-page .bg-light {
    background-color: var(--background-color-light) !important;
  }
  
  [data-theme="dark"] .contact-page .contact-info,
  [data-theme="dark"] .contact-page .contact-form {
    background-color: var(--card-bg);
  }
  
  [data-theme="dark"] .contact-page .text-muted {
    color: var(--text-muted) !important;
  }
</style>
{% endblock %}

{% block extra_scripts %}
<script>
  // Validación del formulario
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contactForm');
    
    if (form) {
      // Aplicar clases de Bootstrap a los campos del formulario
      const inputs = form.querySelectorAll('input, textarea, select');
      inputs.forEach(input => {
        if (!input.classList.contains('form-control')) {
          input.classList.add('form-control');
        }
        
        // Agregar validación en tiempo real
        input.addEventListener('blur', function() {
          if (this.required && !this.value.trim()) {
            this.classList.add('is-invalid');
          } else {
            this.classList.remove('is-invalid');
            this.classList.add('is-valid');
          }
        });
      });
      
      // Validar antes de enviar
      form.addEventListener('submit', function(e) {
        let valid = true;
        
        inputs.forEach(input => {
          if (input.required && !input.value.trim()) {
            input.classList.add('is-invalid');
            valid = false;
          }
        });
        
        if (!valid) {
          e.preventDefault();
          
          // Mostrar alerta
          const alert = document.createElement('div');
          alert.className = 'alert alert-danger alert-dismissible fade show mt-3';
          alert.innerHTML = `
            <i class="fas fa-exclamation-circle me-2"></i>
            Por favor, completa todos los campos obligatorios.
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          `;
          
          form.prepend(alert);
        }
      });
    }
    
    // Animación para los iconos de contacto
    const contactItems = document.querySelectorAll('.contact-item');
    contactItems.forEach((item, index) => {
      item.style.opacity = '0';
      item.style.transform = 'translateY(20px)';
      
      setTimeout(() => {
        item.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        item.style.opacity = '1';
        item.style.transform = 'translateY(0)';
      }, 100 * index);
    });
  });
</script>
{% endblock %}